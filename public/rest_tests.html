<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>Events</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="/execute/css/aqueous" type="text/css" media="screen,projection" />
<link rel="stylesheet" href="/stylesheets/redmond/jquery-ui-1.8.2.custom.css" type="text/css" media="screen,projection" />

<script src="/javascripts/jquery/jquery-1.4.2.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery/jquery.ui.dialog.js" type="text/javascript"></script>
<script src="javascripts/synth.rest.js" type="text/javascript"></script>
</head>
 <style>
    .entry{margin-bottom:8px;}
    img{color:none;background:none;border:none;}
    .IndexNodeAttribute h2 {font-size:12px;color:#444444;border-bottom:none;float:none;display: inline; }
    .IndexNodeAttribute h2 a{color:#444444; }
    .IndexNodeAttribute h2 a:hover{text-decoration:underline;}
    .IndexNodeAttribute span{ border-bottom:none;}
      input{background: none repeat scroll 0 0 #F6F6F6;
      border: 1px solid #CCCCCC;
      color: #777777;
      font: 90% Verdana;}
    #loading{ position:relative;float:right;border: 1px solid #CCCCCC; padding:10px;color: #777777; width:150px;height:20px; background-color:#F6F6F6;display:none;}
 </style>
<body>

<div id="wrapper">
<div id="innerwrapper">

  <div id="header">		
     <form action="/execute/index/http%3A%2F%2Fbase%236515ada0-59bf-11e0-b9e1-00264afffe1d" method="post">
        <input name="authenticity_token" type="hidden" value="MGp1/O1GZ+qSQ42hdbGpYhWjG+dobegSyWVD9p084oI=" /> 
        <input value="Search" name="label_string"/>
     </form>

		
     <h1><a href="/execute/init">Synth - REST API</a></h1>				
     <h2>Semantic Web application development environment</h2>
		
   
<ul id="nav">
    <li><a href="/execute/index/http%3A%2F%2Fbase%2384f5cd60-59bc-11e0-b9e1-00264afffe1d">Events</a></li>
    <li><a href="/execute/index/http%3A%2F%2Fbase%239b6a77f0-59ba-11e0-b9e1-00264afffe1d">Persons</a></li>
    <li><a href="/execute/index/http%3A%2F%2Fbase%23cd5c0070-59bb-11e0-b9e1-00264afffe1d">Publications</a></li>
    <li><a href="/execute/index/http%3A%2F%2Fbase%23436aab30-59bd-11e0-b9e1-00264afffe1d?user%5Bresource%5D=http%3A%2F%2Fsymph%23user">My Program</a></li>
</ul>										
</div>
    
  <div id="sidebar">
    <h2 id='index_title'></h2>
    <h3 style="margin: 0;">Filter</h3>		
    <input id="input_filter" name="" type="text" value="filter" />
  </div>
<script>

 function escape_url(url){
    return escape(url).replace(/[/.%]/gi,"__");
  }
  
function callback_index_node_attr(){ 
  var uri =this.uri;
  var total_nodes = this.nodes.length;
  $('#'+escape_url(uri)).html('');
  var c = 0;
  this.foreach_node(function(key,entry){
                      c++;
                      $('#'+escape_url(uri)).append( '<span id="'+escape_url(this.value)+'"><img src="/images/ajax-loader.gif" border="0"> '+
                      this.value+'</span>'+ 
                      (c == total_nodes ? '' : ', ')
                      );
                    });
  this.request_entries(index_entry_handler);
}
  
  function preview_resource(url){
    var ContextInstance = new Synth.Resource(url, 
                            function(){
                              var value = '';
                              $.each( this.resource_properties[0], function(attr_name, values){
                                value += attr_name + ': ' + values[0].value +'\n'
                              });                              
                              
                              alert('RESOURCE PROPERTIES\n--------------------------------------\n'+value);
                            }); 
  }
  
  function preview_context(url){
    $("#loading").show();
    var ContextInstance = new Synth.ContextInstance(url, 
                            function(){
                               //var div_id = escape_url(url)+'_context';
                               var div_id = "context";
                               $('#'+div_id).remove();
                               var div = $('<div id="'+div_id+'" style="font-size:11px;"></div>').appendTo('body');
                               
                               //Navigational
                               var node_position = this.navigational_properties[0].node_position;
                               var previous_node = this.navigational_properties[0].previous_node;
                               var next_node = this.navigational_properties[0].next_node;
                               if(previous_node)
                                $('<a onclick="preview_context(\''+previous_node+'\')" href="javascript:void(0)"><< Previous</a>').appendTo('#'+div_id);
                               if(previous_node && next_node)
                                $('<span> - </span>').appendTo('#'+div_id);
                               if(next_node)
                                $('<a onclick="preview_context(\''+next_node+'\')" href="javascript:void(0)"> Next >></a>').appendTo('#'+div_id);
                               $(' <hr>').appendTo('#'+div_id);
                               
                               //resource properties
                               $.each( this.resource_properties[0], function(attr_name, values){
                                  var value = '';
                                  $.each(values, function(i, v){ 
                                        value += (i > 0 ? ', ' : '') + v.value +
                                                 (v.uri ? '<sup><a href="javascript:preview_resource(\''+v.uri+'\')">(R)</a></sup>' : '');
                                        });
                                  $('<b>'+attr_name+'</b>: '+ value +'<br />').appendTo('#'+div_id);
                               });
                               
                               // Setting a dialog box
                               $('#'+div_id ).dialog({title: this.label[0], minWidth: 550});
                               $("#loading").hide();
                            });
  }
 
 function index_entry_handler(entry){
    $.each(entry, function(uri, value){
      $('#'+escape_url(uri)).html('');
      var ct = 0;
      $.each( value, 
        function(attr_name, attr){
          var html;
          if(attr[0].type == 'ContextAnchorNodeAttribute' ){
            html = (ct == 0 ? '<h2><a onclick="preview_context(\''+this[0].url+'\')" href="javascript:void(0)">'+attr[0].value+'</a></h2>' : '<b>'+attr_name+'</b>: <a onclick="preview_context(\''+this[0].url+'\')" href="javascript:void(0)">'+attr[0].value+'</a></br>');
          }else if(attr[0].type == 'IndexNodeAttribute'){
            var entry_url = attr[0].value;
            html = '<b>'+attr_name+'</b>: <span class="IndexNodeAttribute" id="'+escape_url(entry_url)+'"> <img src="/images/ajax-loader.gif" border="0"> </span><br />';
            var entry_index = new Synth.Index(entry_url, callback_index_node_attr);
                             
          }else{
            html = '<b>'+attr_name+'</b>: '+attr[0].value+'<br>';
          }
          ct++;
           $('#'+escape_url(uri)).append(html);
        }
      );
    });
  }

function node(key, entry){
  $('<div class="entry" id="'+escape_url(entry.value)+'"><img src="/images/ajax-loader.gif" border="0"> '+entry.value+'</div>').appendTo('#dinamic_content');
}

//Organizations - http:%2F%2Fbase%2301741d00-59be-11e0-b9e1-00264afffe1d
//All Publications - 'http%3A%2F%2Fbase%23cd5c0070-59bb-11e0-b9e1-00264afffe1d'
//Events - http%3A%2F%2Fbase%2384f5cd60-59bc-11e0-b9e1-00264afffe1d

//'http:%2F%2Fbase%23a39aa7c0-3add-11e0-a7b4-00264afffe1d'
function require_index(url){
  if(url){
  var Index = new Synth.Index(url, 
                            function(){
                              $('#dinamic_content').html('');
                              $('#index_title').html(this.title[0]);
                              this.foreach_node(node);
                              this.request_entries(index_entry_handler);
                            });
  }
  
}


$(document).ready(function(){

  $('#input_filter').keyup(function() {
     var value = $(this).val().trim();
     if(value == ""){
       $('.entry').show();            
     }
     else
    {
      var re = new RegExp(value,"i");
      $('.entry').hide()
      $('.entry').filter(function() {
        return re.test($(this).find('h2').text()) 
      }).show();
      }     
  });
  
  $('#request_form').submit(function() {
    var form = $(this).serializeArray();
    require_index(form[0].value);
    return false;
  });
  
});
 
</script>
	
	<div id="contentnorightbar">
    
    <form id='request_form'>
     Index URI: <input id="index_url" name="index_url" type="text" value="http%3A%2F%2Fbase%23cd5c0070-59bb-11e0-b9e1-00264afffe1d" style="width:440px"/>
      <input type="submit" value="Load"  style="width:40px"/>
    </form>
    <div id='loading'>  <img src="/images/ajax-loader.gif" border="0"> Loading... </div>
    <div id="dinamic_content"></div>
    
 </div>
 <div id="footer">
   <!-- If you wish to delete this line of code please purchase our commercial license http://www.sixshootermedia.com/shop/commercial-license/ -->
    <p>Template design by <a href="http://www.sixshootermedia.com">Six Shooter Media</a>.</p>
</div>
 </div>
</div>
</body>
</html>